# i18n Strategy — Louhen Landing

This document governs locale and market handling for the landing experience. All paths, redirects, and storage mechanisms must match the locked URL strategy recorded in `decision_log.md`.

---

## Locale Path Format (BCP-47)

- Paths use lowercase BCP-47 tags in the form `/language-region/` (e.g., `/en-de/`, `/de-de/`, `/fr-fr/`, `/en-eu/`).
- Locale prefixes apply to every page variant: `/fr-fr/`, `/fr-fr/blog/...`, `/en-at/method`, etc.
- The root `/` is an x-default entry that detects humans (Accept-Language + geo hint) and offers a one-time suggestion/302 to the market default. Bots always receive the x-default content without redirects.
- Legacy `/de/` (and descendants) must permanently redirect (308) to `/de-de/`.

Locale definitions live in `lib/intl/registry.ts` and are re-exported through `next-intl.locales.ts`. Update that registry (and only that registry) when adding locales so middleware, sitemap, metadata, and the switcher stay aligned.

| Locale | Language | Region / Market | Default Path Example |
| ------ | -------- | ---------------- | -------------------- |
| `en-de` | English | Germany | `/en-de/` |
| `de-de` | German | Germany | `/de-de/` |
| `fr-fr` | French | France | `/fr-fr/` |
| `en-at` | English | Austria | `/en-at/` |
| `en-nl` | English | Netherlands | `/en-nl/` |
| `en-eu` | English | EU fallback | `/en-eu/` (also `x-default` target) |

---

## Market Defaults & Expansion Policy

- Current market defaults:
  - DE → `/en-de/`
  - FR → `/fr-fr/`
  - AT → `/en-at/`
  - NL → `/en-nl/`
  - Fallback EU → `/en-eu/`
- To add a new market/language pair:
  1. Assign a lowercase BCP-47 tag and confirm it does not collide with existing routes.
  2. Add localized content and translations for all required surfaces.
  3. Update middleware detection rules, hreflang map, sitemaps, and switcher configuration.
  4. Document the new market default here and in `decision_log.md` if it becomes locked.
- Do not introduce domain-per-locale behavior without a new proposal.

---

## Preference Storage & Telemetry

- Middleware and the locale switcher set a strictly necessary cookie `lh_locale` containing the active locale (six-month TTL, `SameSite=Lax`).
- When the user grants marketing consent, the switcher mirrors the locale into `localStorage` so other channels can pick up the preference; avoid touching `localStorage` without consent.
- Every switch emits a `locale_changed` analytics event with `{ from, to, preservedPath }` and the pageview context includes `locale`, `language`, and `region` captured from `<html data-*>` attributes. Update downstream analytics dashboards if these fields change.

---

## Switcher UX Rules

- Preserve the current path when the target locale has the same slug. Example: `/fr-fr/blog/fit-guide` → switch to `/de-de/blog/fit-guide` if available.
- When the target locale lacks the requested path, fall back to the target locale homepage (e.g., `/en-nl/`).
- Always show the currently active locale in the switcher and expose the market name (language + region) in human-readable copy. Options are sourced from the registry label fields.
- When marketing consent is present, persist the choice in `localStorage`; always persist the cookie.
- Vanilla bots/crawlers should see consistent, non-interactive switcher markup without auto-redirects.

---

## Content & Slugs

- Prefer fully translated slugs for key markets. Shared slugs across locales are acceptable as an interim measure while translations land.
- Keep canonical IDs stable—changing a slug requires updating redirects, hreflang, and sitemap entries.
- Coordinate with SEO to ensure new slugs appear in the appropriate locale sitemap and hreflang matrix.

---

## Compliance Checklist (for locale changes)

- [ ] Locale path follows BCP-47 lowercase pattern.
- [ ] Root `/` suggestion flow verified for humans; bots receive x-default.
- [ ] `lh_locale` cookie behaviour tested; localStorage gated by consent.
- [ ] Switcher preserves path or falls back gracefully.
- [ ] Hreflang, canonical, and sitemap entries updated for the locale.
- [ ] Redirects (including legacy `/de/`) remain intact.
