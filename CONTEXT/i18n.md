# Internationalization Notes

## Locale Strategy
- Routes use the BCP-47 locale segment pattern (`/[locale]/…`) with lowercase language codes and optional region (see `routing.md`).
- Production canonical host is `https://www.louhen.app`; localized canonical tags must mirror this host even in pre-launch mode.

## Market Overlays (BCP-47)
- Base language catalogs remain in `messages/en.json` and `messages/de.json`.
- Market overlays live beside them using full BCP-47 tags (e.g., `messages/en-de.json`, `messages/de-de.json`) and must only contain diffs from the base catalog.
- Fallback chains resolve exact market overlays first, then cascade to regional bases:
  - `en-de` → `en`
  - `de-de` → `de`
  - `de-at` → `de-de` → `de` (create `messages/de-at.json` only when Austria launches).
- Do not duplicate shared copy in overlays; move overrides only when wording diverges for a market.
- When adding a new market, update the fallback table here and ensure the loader merges overlays in the same order.

## Legal Namespaces
- New translation namespaces: `legal.terms.*` and `legal.privacy.*`.
- Use nested keys for sections (e.g., `legal.terms.title`, `legal.privacy.dataRights.heading`). Keep keys human-readable.
- Shared snippets (e.g., contact addresses, consent statements) live in `legal.common.*` to avoid duplication.
- Metadata builders rely on:
  - `method.seo.title` and `method.seo.description` for marketing routes.
  - `legal.terms.title`, `legal.terms.intro`, `legal.privacy.title`, and at least the first entry in `legal.privacy.purpose.items` to seed descriptions.

## Placeholder & Entity Handling
## Message Formatting Rules
- Use `t()` for plain messages with simple `{placeholder}` values and pass already formatted strings (no React nodes).
- Use ICU formats for dates/numbers (e.g., `{date, date, long}`) when passing Date/number objects.
- Use `t.rich()` only when translations contain inline tags; provide handlers for every tag (e.g., `strong`, `link`, `email`).
- Keep placeholders identical across locales and align with the arguments passed in code (no extra or missing keys).
- Avoid escaped double braces; prefer `<tag>{value}</tag>` for rich messages.

- Company name/address remain placeholders until GmbH registration. Represent them as `[[Company legal name pending GmbH registration]]` in source messages so translators keep them intact.
- Tag data-subject contact emails (`legal@louhen.eu`, `privacy@louhen.eu`) as non-translatable strings.
- When analytics consent tooling changes, update the shared copy once in `legal.common.analyticsConsent` and re-export catalogs.

## Workflow
- Source of truth is the English (`en`) catalog committed in `messages/`.
- For each new legal section:
  1. Add English copy to the relevant namespace.
  2. Export placeholder files for other locales via the existing `next-intl` scripts (see `package.json` `messages:*` commands).
  3. Mark untranslated strings with `[[TODO-translate]]` so Playwright regression tests flag missing copy.
  4. Review translations with legal counsel before publishing.

## Date & Revision Formatting
- Display last-updated timestamps using locale-specific long-date formats (e.g., `January 5, 2026` for `en`, `5. Januar 2026` for `de`).
- Store the canonical ISO string (`YYYY-MM-DD`) alongside the localized output for audit trails; expose ISO strings in structured data only.
- Update the revision date simultaneously across Terms, Privacy, and sitemap metadata to keep change logs aligned.

## Testing Hooks
- Tests should assert that `<h1>` and metadata titles come from the `legal.*` namespaces, not hardcoded strings.
- Fallback locale must never leak; default locale pages should render without duplicated prefixes in canonical URLs.

- 2025-02-14 — Legal namespaces seeded (Pattern A: extended messages/en.json and messages/de.json).

- 2025-02-14 — BCP-47 overlays added (en-de/de-de) with fallback chains documented.
